---
title: "A6.Rmd"
author: "Kristan D Ramirez"
date: "2/10/2020"
output: word_document
---
# Predict Admit to University.


## A.) Change the data type for columns as needed, and split the data in train and test in a 6:4 ratio randomly.
```{r}
data <- read.csv('/Users/kris/Documents/maturity.csv')
#head(data)
str(data) # 199 obs, 3 vars. all integers. 
table(data$Maturity) # Target Variable? 1-6
table(data$Type) # 0s and 1s; 1=Private, 0= Public, 82 Public, 117 Private
table(data$Admit) #0s and 1s: 1 = Admitted, 0=Otherwise, 58 Admitted, 141 Otherwise.


```



```{r}
# Convert 'Type' and 'Admit' to factors:
data$Type<-as.factor(data$Type)
data$Admit<-as.factor(data$Admit)

# Verify the variable was converted to factor:
str(data)
```
```{r}
# Partition data into training and testing 6:4 ratio:
library(caret)
set.seed(123)
#Target Variable: 'Admit'
#Partition<-createDataPartition(y=data$Admit, p=0.6, list=FALSE )
Partition<-sample(c(1:dim(data)[1]), dim(data)[1]*0.6)
Train <- data[Partition, ]
Test <- data[-Partition, ]
#str(Train) # 119 obs
#str(Test) # 80 obs

```
##  B.) Train the model on Training set, display the summary of the trained model, and write the equation.
```{r}
# *Create Model* w/ LOGISTIC REGRESSION w/ glm() and *Training* data: 
myLogit <- glm(Admit~Maturity+Type, data = Train, family="binomial")
options(scipen=999)
summary(myLogit) # DISCUSS SUMMARY RESULTS!!!! AND WRITE THE EQUATION
 
#head(data)

```

## EQUATION of Estimation Functon: logit(p) = -8.4251+1.7030Maturity+2.1005Type.

## We can now use this equation to plug-in the existing numbers from our dataset to determine the classification.

### If we take the first observation set: Maturity =1, Type= 1, and Admit= 1:
### logit(p) = -6.9802 + 1.6532*1 + 2.0903*1
### logit(p) = -3.2367

### P =e^ -3.2367/ 1 + e^ -3.2367
### P = 0.03929 / 1.03929
### P = 0.0378



## C.) Use the model to predict the values on the test dataset, and explain the results:
### Results: 87.5 percent accuracy. Correctly predicted 70/80 if a student would or would not be Admitted based on Predictor Variables.  The model correctly predicted 52/59 as not accepted and 18/21 as accepted. 
```{r}
# *Prediction function* for 'Admit' w/ use of Logistic Regression and *Test* data.
myLogitPred<- predict(myLogit, Test[, -3], type="response")
#myLogisPred is now the prediction for Admit

#class(Test$Admit) # Factor
#class(myLogitPred) #Numberic


# Confusion Matrix to compare prediction to actual:
confusionMatrix(as.factor(as.numeric(myLogitPred>0.5,1,0)), Test$Admit)
```

```{r}



Test['Prediction']= myLogitPred
Test$Prediction <- ifelse(Test$Prediction > 0.5, 1, 0)
Test$Type<- as.integer(as.factor(Test$Type))
Test$Type<- ifelse(Test$Type==2,1,0)
class(Test$Type) # factor
class(Test$Maturity) # integer
Int<-coef(myLogit)['(Intercept)']
Mat<-coef(myLogit)['Maturity']
Typ<-coef(myLogit)['Type1']
Test['myLogitP'] = (coef(myLogit)['(Intercept)']+(Mat*Test$Maturity)+(Typ*Test$Type))
head(Test)

Test['P'] <- ((exp(Test$myLogitP))/(1+exp(Test$myLogitP)))

head(Test)
```






---
title: "Bayes2.Rmd"
author: "Kristan D Ramirez"
date: "2/11/2020"
output: word_document
---

# Bayesian Classifier

## a.) Import the dataset and display the data frame snapshot (using str() function) (10 pts)
```{r}
df <- read.csv('/Users/kris/Documents/accidents.csv')
# Snapshot of data frame
str(df)

```

## b.) Create a dummy variable called INJURY that takes the value "yes" if MAX_SER_IR=1 or 2, or otherwise "no." (30 pts)
```{r}
df$INJURY <- ifelse(df$MAX_SEV_IR=='1'|df$MAX_SEV_IR=='2', "yes", "no") 
str(df)

df$MAX_SEV_IR[df$MAX_SEV_IR == '1' |  df$MAX_SEV_IR== '2'] <- "yes" 
df$MAX_SEV_IR[df$MAX_SEV_IR == '0'] <- "no" 
#any(is.na(df$MAX_SEV_IR))

# New Variable INJURY w/ 'yes' 'no'
df$INJURY <- df$MAX_SEV_IR

#str(df)
```
## c.) Select the first 12 records in the dataset and look only at the response (INJURY) and the two predictors WEATHER_R and TRAF_CON_R.
```{r}
# isolating specific rows and columns.
new.df <- df[1:12, c(25,19, 16)]
new.df
```

## Compute the NaÃ¯ve Bayes conditional probabilities of an injury (INJURY=yes) given the possible combinations of the predictors.



```{r}
str(new.df)
# Convert to factors
new.df2 <- cbind(new.df, INJURY = as.factor(new.df$INJURY), WEATHER_R = as.factor(new.df$INJURY), TRAF_CON_R = as.factor(new.df$TRAF_CON_R))

#str(new.df2)

new.df3 <- new.df2[,-c(1:3)]

#str(new.df3) # Verify.

#Naive <- naiveBayes(INJURY~., data=new.df3)
#Naive 
```




## Split the dataset into two sets (test and train).  using Naive Bayes from e1071 package, compare the results, and report the accuracy and confidence interval. (30 pts)
```{r}
library(caret)
set.seed(1234)
intrain <- createDataPartition(y=new.df3$INJURY, p=0.7, list=FALSE) 
trainSet <- new.df3[intrain, ]
testSet <- new.df3[-intrain, ]


library(e1071)
# Conditional Probability for calculation:
Naive <- naiveBayes(INJURY~., data=trainSet)
Naive 


# Prediction Function:
Predict <- predict(Naive, newdata = testSet, type='class')


# Accuracy of the  predicted model:
Actual <- testSet$INJURY


confusionMatrix(Actual, Predict)
```


```{r}
## predict probabilities
pred.prob <- predict(Naive, newdata = testSet, type = "raw")
## predict class membership
pred.class <- predict(Naive, newdata = testSet)


df <- data.frame(actual = testSet$INJURY, predicted = pred.class, pred.prob)
df[testSet$WEATHER_R == "1" & testSet$TRAF_CON_R == "2",]



```